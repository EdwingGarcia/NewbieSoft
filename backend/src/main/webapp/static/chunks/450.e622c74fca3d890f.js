"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{3450:(e,r,a)=>{a.r(r),a.d(r,{default:()=>b});var s=a(5155),o=a(8661),t=a.n(o),i=a(2115),l=a(1733),n=a(5229),d=a(6983),c=a(508),x=a(3664),p=a(9141),m=a(1873),f=a(9470),g=a(6651);let u=e=>{let{label:r,value:a,icon:o,monospace:t}=e;return(0,s.jsxs)("div",{style:{display:"flex",gap:"0.8rem",alignItems:"flex-start"},children:[o&&(0,s.jsx)("div",{style:{marginTop:"2px",color:"#64748b"},children:o}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,s.jsx)("span",{style:{fontSize:"0.65rem",color:"#94a3b8",textTransform:"uppercase",fontWeight:700,letterSpacing:"0.05em"},children:r}),(0,s.jsx)("span",{style:{fontSize:"0.85rem",color:"#334155",fontWeight:500,fontFamily:t?"monospace":"inherit",wordBreak:"break-word"},children:a||"—"})]})]})};function h(e){var r;let{cita:a,onClose:o}=e;(0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&o()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o]);let t=(null!=(r=a.estado)?r:"").toUpperCase(),l="COMPLETADA"===t?{bg:"#dcfce7",border:"#86efac",text:"#166534"}:"CANCELADA"===t?{bg:"#fee2e2",border:"#fecaca",text:"#991b1b"}:{bg:"#e0e7ff",border:"#c7d2fe",text:"#4338ca"};return(0,s.jsx)("div",{role:"dialog","aria-modal":"true",onClick:o,style:{position:"fixed",inset:0,width:"100vw",height:"100vh",background:"rgba(2, 6, 23, 0.6)",backdropFilter:"blur(4px)",zIndex:3e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:(0,s.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{width:"100%",maxWidth:"750px",borderRadius:"16px",backgroundColor:"#fff",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden",display:"flex",flexDirection:"column",maxHeight:"90vh"},children:[(0,s.jsxs)("div",{style:{padding:"1rem 1.5rem",background:"linear-gradient(90deg,#4338ca,#7c3aed)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{fontSize:"0.75rem",color:"#c7d2fe",fontWeight:700},children:["CITA #",String(a.id).padStart(4,"0")]}),(0,s.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:600},children:"Detalle de Servicio"})]}),(0,s.jsx)("button",{onClick:o,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"#fff",borderRadius:"50%",width:32,height:32,display:"grid",placeItems:"center",cursor:"pointer"},children:(0,s.jsx)(n.A,{size:18})})]}),(0,s.jsxs)("div",{style:{padding:"1.5rem",overflowY:"auto"},children:[(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem",paddingBottom:"1.5rem",borderBottom:"1px solid #e2e8f0"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",fontWeight:700,marginBottom:"0.4rem"},children:"ESTADO"}),(0,s.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.35rem 0.75rem",borderRadius:"99px",background:l.bg,border:"1px solid ".concat(l.border),color:l.text,fontWeight:700,fontSize:"0.8rem"},children:[(0,s.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:l.text}}),a.estado]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontSize:"0.7rem",color:"#64748b",fontWeight:700,marginBottom:"0.4rem"},children:"FECHA"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#0f172a",fontWeight:600},children:[(0,s.jsx)(d.A,{size:16,color:"#6366f1"}),new Date(a.fechaProgramada).toLocaleString("es-ES")]})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[(0,s.jsxs)("div",{style:{background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",padding:"1.25rem"},children:[(0,s.jsxs)("h4",{style:{margin:"0 0 1rem 0",fontSize:"0.85rem",fontWeight:800,color:"#0f172a",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,s.jsx)(c.A,{size:16})," CLIENTE"]}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,s.jsx)(u,{label:"Nombre",value:a.usuario.nombre}),(0,s.jsx)(u,{label:"C\xe9dula",value:a.usuario.cedula,monospace:!0}),(0,s.jsx)(u,{label:"Correo",value:a.usuario.correo,icon:(0,s.jsx)(x.A,{size:14})}),(0,s.jsx)(u,{label:"Tel\xe9fono",value:a.usuario.telefono,icon:(0,s.jsx)(p.A,{size:14}),monospace:!0}),(0,s.jsx)(u,{label:"Direcci\xf3n",value:a.usuario.direccion,icon:(0,s.jsx)(m.A,{size:14})})]})]}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,s.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e2e8f0",padding:"1.25rem"},children:[(0,s.jsxs)("h4",{style:{margin:"0 0 1rem 0",fontSize:"0.85rem",fontWeight:800,color:"#0f172a",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,s.jsx)(f.A,{size:16})," T\xc9CNICO"]}),(0,s.jsx)(u,{label:"Nombre",value:a.tecnico.nombre})]}),(0,s.jsxs)("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e2e8f0",padding:"1.25rem",flex:1},children:[(0,s.jsx)("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.85rem",fontWeight:800,color:"#0f172a"},children:"MOTIVO"}),(0,s.jsx)("p",{style:{fontSize:"0.9rem",color:"#334155",lineHeight:1.6,background:"#f1f5f9",padding:"0.75rem",borderRadius:"8px"},children:a.motivo})]})]})]})]}),(0,s.jsx)("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e2e8f0",background:"#f8fafc",display:"flex",justifyContent:"flex-end"},children:(0,s.jsx)("button",{onClick:o,style:{padding:"0.5rem 1.5rem",background:"#fff",border:"1px solid #cbd5e1",borderRadius:"8px",fontWeight:600,cursor:"pointer",color:"#0f172a"},children:"Cerrar"})})]})})}function b(){let[e,r]=(0,i.useState)([]),[a,o]=(0,i.useState)(!0),[n,c]=(0,i.useState)(null),[x,p]=(0,i.useState)(null),[f,u]=(0,i.useState)(null),[b,j]=(0,i.useState)(""),y=localStorage.getItem("token")||localStorage.getItem("nb.auth.token"),v=localStorage.getItem("cedula"),k=async()=>{if(y&&v){o(!0),c(null);try{let e=await fetch("".concat(l.JR,"/api/citas/tecnico/").concat(v),{headers:{Authorization:"Bearer ".concat(y)}});if(!e.ok)throw Error("Error al cargar citas");let a=await e.json();r(Array.isArray(a)?a:[])}catch(e){console.error(e),c("No se pudieron cargar tus citas.")}finally{o(!1)}}};(0,i.useEffect)(()=>{k()},[]);let S=async(e,a,s)=>{if(s&&s.stopPropagation(),y){p(e);try{if(!(await fetch("".concat(l.JR,"/api/citas/").concat(e,"/completar"),{method:"POST",headers:{Authorization:"Bearer ".concat(y),"Content-Type":"application/json"},body:JSON.stringify({estado:a})})).ok)throw Error("Error actualizando");r(r=>r.map(r=>r.id===e?{...r,estado:a}:r))}catch(e){console.error(e),alert("Error actualizando la cita")}finally{p(null)}}},w=(0,i.useMemo)(()=>{if(!b)return e;let r=b.toLowerCase();return e.filter(e=>"".concat(e.motivo," ").concat(e.usuario.nombre," ").concat(e.usuario.cedula," ").concat(e.usuario.direccion," ").concat(e.usuario.correo," ").concat(e.id).toLowerCase().includes(r))},[e,b]),z=new Date,C=[],N=[],A=[];w.forEach(e=>{let r=(e.estado||"").toUpperCase(),a=new Date(e.fechaProgramada);"COMPLETADA"===r?A.push(e):"PENDIENTE"===r&&(a<z?C.push(e):N.push(e))});let D=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(e.estado||"").toUpperCase();return(0,s.jsxs)("div",{onDoubleClick:()=>u(e),title:"Doble clic para ver detalles",style:{border:r?"1px solid #f87171":"1px solid #e2e8f0",borderLeft:r?"5px solid #dc2626":"1px solid #e2e8f0",borderRadius:"10px",padding:"1rem",background:"#fff",display:"flex",flexDirection:"column",gap:"0.6rem",boxShadow:"0 2px 4px rgba(0,0,0,0.03)",cursor:"pointer",userSelect:"none",transition:"transform 0.1s ease-in-out"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.01)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,s.jsx)("strong",{style:{fontSize:"0.9rem",color:"#1e293b",lineHeight:1.3},children:e.motivo||"Cita t\xe9cnica"}),r&&(0,s.jsx)("span",{style:{fontSize:"0.65rem",background:"#fee2e2",color:"#991b1b",padding:"2px 6px",borderRadius:"4px",fontWeight:"800"},children:"ATRASADA"})]}),(0,s.jsxs)("div",{style:{padding:"0.5rem",background:"#f8fafc",borderRadius:"6px",border:"1px solid #f1f5f9"},children:[(0,s.jsxs)("span",{style:{fontSize:"0.8rem",color:"#334155",display:"block",fontWeight:600},children:["\uD83D\uDC64 ",e.usuario.nombre]}),(0,s.jsxs)("span",{style:{fontSize:"0.75rem",color:"#64748b",display:"block"},children:["ID: ",e.usuario.cedula]}),(0,s.jsxs)("span",{style:{fontSize:"0.75rem",color:"#64748b",display:"flex",alignItems:"center",gap:"4px",marginTop:"2px"},children:[(0,s.jsx)(m.A,{size:10})," ",e.usuario.direccion]})]}),(0,s.jsxs)("span",{style:{fontSize:"0.8rem",color:"#475569",display:"flex",alignItems:"center",gap:"5px"},children:[(0,s.jsx)(d.A,{size:12})," ",new Date(e.fechaProgramada).toLocaleString("es-ES")]}),"COMPLETADA"!==a&&(0,s.jsx)("div",{style:{marginTop:"0.5rem"},children:(0,s.jsx)("button",{disabled:x===e.id,onClick:r=>S(e.id,"COMPLETADA",r),style:{width:"100%",padding:"0.6rem",background:r?"#dc2626":"#16a34a",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",opacity:x===e.id?.7:1,fontWeight:700,fontSize:"0.8rem",boxShadow:"0 2px 5px rgba(0,0,0,0.1)"},children:x===e.id?"Guardando...":"✔ Marcar como Completada"})})]},e.id)},E={maxHeight:"600px",overflowY:"auto",paddingRight:"5px",display:"flex",flexDirection:"column",gap:"1rem"};return(0,s.jsxs)("div",{style:{padding:"1.5rem",background:"linear-gradient(to bottom right, #f8fafc, rgba(243, 232, 255, 0.3))",minHeight:"100%",height:"100%",display:"flex",flexDirection:"column"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("div",{style:{marginBottom:"1.5rem",background:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",borderRadius:"16px",border:"1px solid #e9d5ff",boxShadow:"0 10px 15px -3px rgba(147, 51, 234, 0.05)",padding:"1.5rem"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem",marginBottom:"1rem"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsx)("div",{style:{padding:"0.5rem",background:"linear-gradient(to bottom right, #a855f7, #9333ea)",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgba(147, 51, 234, 0.25)"},className:"jsx-215e7a9018e5749e",children:(0,s.jsx)("svg",{style:{width:"20px",height:"20px",color:"white"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-215e7a9018e5749e",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",className:"jsx-215e7a9018e5749e"})})}),(0,s.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:800,color:"#0f172a",margin:0},className:"jsx-215e7a9018e5749e",children:"Tablero de Citas"})]}),(0,s.jsxs)("div",{style:{fontSize:"0.9rem",color:"#7c3aed"},className:"jsx-215e7a9018e5749e",children:["Mostrando ",(0,s.jsx)("b",{className:"jsx-215e7a9018e5749e",children:w.length})," de ",e.length]})]}),(0,s.jsxs)("div",{style:{position:"relative",width:"100%",maxWidth:"500px"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsx)("div",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#a855f7"},className:"jsx-215e7a9018e5749e",children:(0,s.jsx)(g.A,{size:18})}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar por cliente, c\xe9dula, direcci\xf3n...",value:b,onChange:e=>j(e.target.value),style:{width:"100%",padding:"0.8rem 1rem 0.8rem 2.5rem",borderRadius:"12px",border:"1px solid #e9d5ff",fontSize:"0.95rem",boxShadow:"0 2px 5px rgba(147,51,234,0.05)",outline:"none"},className:"jsx-215e7a9018e5749e"})]})]}),a&&(0,s.jsx)("p",{className:"jsx-215e7a9018e5749e",children:"Cargando citas..."}),n&&(0,s.jsx)("div",{style:{color:"#ef4444",marginBottom:"1rem"},className:"jsx-215e7a9018e5749e",children:n}),!a&&(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"1.5rem",alignItems:"start",flex:1},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("div",{style:{background:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",padding:"1rem",borderRadius:"16px",border:"1px solid #fca5a5",boxShadow:"0 10px 15px -3px rgba(220, 38, 38, 0.05)"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("h2",{style:{fontSize:"1rem",color:"#b91c1c",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:800,paddingBottom:"0.5rem",borderBottom:"1px dashed #fca5a5"},className:"jsx-215e7a9018e5749e",children:["\uD83D\uDEA8 Atrasadas ",(0,s.jsx)("span",{style:{background:"#fee2e2",padding:"2px 8px",borderRadius:"10px",fontSize:"0.8rem"},className:"jsx-215e7a9018e5749e",children:C.length})]}),(0,s.jsxs)("div",{style:E,className:"jsx-215e7a9018e5749e custom-scroll",children:[0===C.length&&(0,s.jsx)("span",{style:{fontSize:"0.8rem",color:"#94a3b8",textAlign:"center",padding:"1rem"},className:"jsx-215e7a9018e5749e",children:"\xa1Al d\xeda! No hay citas atrasadas."}),C.map(e=>D(e,!0))]})]}),(0,s.jsxs)("div",{style:{background:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",padding:"1rem",borderRadius:"16px",border:"1px solid #e9d5ff",boxShadow:"0 10px 15px -3px rgba(147, 51, 234, 0.05)"},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("h2",{style:{fontSize:"1rem",color:"#7c3aed",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:800,paddingBottom:"0.5rem",borderBottom:"1px dashed #e9d5ff"},className:"jsx-215e7a9018e5749e",children:["⏳ Pr\xf3ximas ",(0,s.jsx)("span",{style:{background:"#f3e8ff",padding:"2px 8px",borderRadius:"10px",fontSize:"0.8rem"},className:"jsx-215e7a9018e5749e",children:N.length})]}),(0,s.jsxs)("div",{style:E,className:"jsx-215e7a9018e5749e custom-scroll",children:[0===N.length&&(0,s.jsx)("span",{style:{fontSize:"0.8rem",color:"#94a3b8",textAlign:"center",padding:"1rem"},className:"jsx-215e7a9018e5749e",children:"No tienes citas pendientes."}),N.map(e=>D(e,!1))]})]}),(0,s.jsxs)("div",{style:{background:"rgba(248,250,252,0.8)",backdropFilter:"blur(8px)",padding:"1rem",borderRadius:"16px",border:"1px solid #e9d5ff",opacity:.9},className:"jsx-215e7a9018e5749e",children:[(0,s.jsxs)("h2",{style:{fontSize:"1rem",color:"#15803d",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:800,paddingBottom:"0.5rem",borderBottom:"1px dashed #c4b5fd"},className:"jsx-215e7a9018e5749e",children:["✅ Historial ",(0,s.jsx)("span",{style:{background:"#dcfce7",padding:"2px 8px",borderRadius:"10px",fontSize:"0.8rem"},className:"jsx-215e7a9018e5749e",children:A.length})]}),(0,s.jsxs)("div",{style:E,className:"jsx-215e7a9018e5749e custom-scroll",children:[0===A.length&&(0,s.jsx)("span",{style:{fontSize:"0.8rem",color:"#94a3b8",textAlign:"center",padding:"1rem"},className:"jsx-215e7a9018e5749e",children:"Historial vac\xedo."}),A.map(e=>D(e,!1))]})]})]}),f&&(0,s.jsx)(h,{cita:f,onClose:()=>u(null)}),(0,s.jsx)(t(),{id:"215e7a9018e5749e",children:".custom-scroll::-webkit-scrollbar{width:6px}.custom-scroll::-webkit-scrollbar-track{background:transparent}.custom-scroll::-webkit-scrollbar-thumb{background-color:#cbd5e1;border-radius:20px}.custom-scroll::-webkit-scrollbar-thumb:hover{background-color:#94a3b8}"})]})}}}]);